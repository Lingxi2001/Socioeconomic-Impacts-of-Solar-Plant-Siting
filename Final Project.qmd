---
title: "Socioeconomic Impacts of Solar Plant Siting"
subtitle: "PPOL 6805: GIS for Spatial Data Science Final Project"
author: "Lingxi Li"
email: "ll1188@georgetown.edu"
affiliation: "Georgetown University"
execute:
  cache: true
  warning: false
bibliography: "GIS_references.bib"
title-block-banner: "#E69F0095"
title-block-banner-color: "white"
format:
 html:
    df-print: kable
    toc: true
    link-citations: true
    prefer-html: true
    self_contained: true

---

# Introduction
The rapid development of renewable energy technologies have become vital to addressing the challenges of climate change and energy security. Among these technologies, solar energy plays a important role due to its availability and cheaper cost. The effective utilization of solar resources is influenced by the location of energy plants. This report will preliminary examine the factors influencing the siting of solar plants in the United States and evaluate the socio-economic impact of the location choosing.

By employing spatial analysis methods, including Moran’s I, kernel density estimation, and regression models, this study seeks to provide an in-depth assessment of the geographic and economic dimensions of renewable energy plant siting.

# Literature Review

## Factors Influencing Energy Plant Siting

Many studies have focused on the factors influencing solar plant location choosing, with solar radiation widely recognized as a critical determinant. For instance, Ong et al. (2013)[@ong_land-use_2013] highlighted that Global Horizontal Irradiance (GHI) is one of the essential for identifying optimal locations for solar plants. High-radiation areas not only maximize energy production efficiency but also significantly reduce production costs.

This statement is further supported by the work of Hassaan et al. (2021)[@hassaan_gis-based_2021] , who used Geographic Information Systems (GIS) to analyze potential sites for photovoltaic plants in Kuwait.Their study identified solar radiation intensity as one of the key criteria for site suitability. Similarly, Sun et al. (2023)[@sun_spatial_2023] investigated the spatial distribution of large-scale solar photovoltaic plants in China, emphasizing solar radiation as a major driving factor influencing plant locations.

These studies collectively demonstrate that solar radiation intensity plays a crucial role in determining the siting of solar plants. Given this, it is both logical and necessary to validate this relationship within the context of the United States.

## Employment and Unemployment Implications of Energy Transition

Many studies have explored the impact of energy transition on the labor market. On one hand, several studies highlight the positive effects of renewable energy development on employment. For instance, Wei et al. (2010)[@wei_putting_2010] pointed out that renewable energy projects, compared to traditional fossil fuels, can generate significantly more jobs per unit of energy production.

On the other hand, concerns about unemployment during the energy transition have also been widely discussed. Güler et al. (2024)[@guler_effect_2024] found that in countries with high unemployment rates or less flexible labor markets, energy transitions could exacerbate economic pressures. Similarly, Zhang et al. (2024)[@zhang_job_2024] indicated that during the energy transition, coal-rich regions experience significant unemployment, whereas regions rich in wind and solar resources see notable employment growth.

These contrasting findings highlight the complexity of energy transitions, emphasizing the need for further analysis using geographic information to better understand regional disparities and labor market dynamics.

# Methodology

This study examines two key questions to explore the alignment between solar plant locations and solar radiation intensity, as well as the economic impacts of siting conflicts.

## Research Question 1: How well do renewable energy plants align with local energy resource availability?

To evaluate the alignment between solar plant and resource availability, the author uses the spatial distribution of solar plants as the dependent variable and solar radiation intensity (measured by Global Horizontal Irradiance, GHI) as the independent variable. 

For the analysis, the author first map the solar radiation and solar plant distribution, providing an intuitive assessment of their relationship and identifying siting patterns. Next, kernel density estimation is used to calculate the spatial density of solar plants in order to confirm the assessment. Finally, OLS regression is applied to quantify the relationship between solar radiation intensity and the number of solar plants. The regression analysis also incorporates population factors to evaluate the relative importance in site selection.

## Research Question 2: What's the economic impact of siting conflicts between renewable and traditional energy plants?

To evaluate the economic impacts of siting conflicts between renewable and traditional energy plants, the author examines two key metrics: employment growth rate and unemployment growth rate. Conflict zones is identified as areas where renewable energy plants and coal plants are located within 10 km of each other. Employment and unemployment growth rates are then calculated using data from 2020 and 2021.

The analysis begins with spatial buffering to identify conflict zones and uses T-tests to compare employment and unemployment growth rates between conflict and non-conflict zones. Then,  Spatial visualizations are used to map these economic indicators, highlighting regional disparities. Finally, hypothesis testing is conducted using kernel density estimation and Monte Carlo simulations to verify whether the density of energy plants is significantly higher in conflict zones than in non-conflict zones.

# Exploratory Data Analysis

```{r}
# Load required libraries
library(sf)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(spatstat)
library(mapview)
library(httr)
library(jsonlite)
library(terra)
library(spdep)
library(lwgeom)
library(raster)
library(spatialreg)
library(readxl)
library(tigris)
```

## Research Question 1: How well do renewable energy plants align with local energy resource availability?

To begin with, we first map the solar radiation and solar plants distribution. 
```{r}
# Import data
power_plants <- read.csv("data/Power_Plants.csv")
solar_radiation <- rast("data/USA_GISdata/western-hemisphere/GHI.tif")

# Set US boundary
us_boundary <- st_as_sf(rnaturalearth::ne_states(country = "United States of America")) |>
  filter(!name %in% c("Hawaii", "Alaska", "Puerto Rico")) 

# Solar plants data
solar_plants <- power_plants |>
  dplyr::select(State, PrimSource, Total_MW, Longitude, Latitude)|>
  filter(PrimSource == "solar", !State %in% c("Alaska", "Hawaii", "Puerto Rico"), !is.na(Total_MW))
solar_plants_sf <- st_as_sf(solar_plants, coords = c("Longitude", "Latitude"), crs = 4326) |>
  st_intersection(us_boundary)

# Solar radiation level data
solar_radiation_resampled <- aggregate(solar_radiation, fact = 100)
solar_radiation_resampled <- crop(solar_radiation_resampled, us_boundary)
solar_radiation_df <- as.data.frame(solar_radiation_resampled, xy = TRUE) |>
  filter(!is.na(GHI))

# Visualize solar radiation level and solar plants
ggplot() +
  geom_raster(data = solar_radiation_df, aes(x = x, y = y, fill = GHI)) +
  scale_fill_viridis_c(option = "C", name = "Radiation (kWh/m²)") +  
  geom_sf(data = solar_plants_sf, color = "darkblue", size = 0.8, alpha = 0.4) +
  geom_sf(data = us_boundary, fill = NA, color = "white", size = 0.5) +
  labs(title = "Solar Radiation and Solar Plant Distribution",
       x = "Longitude", y = "Latitude") +
  theme_minimal()
```
As the graph shows above, the solar radiation mainly concentrated in the southwest of the United States where does not gather very many solar power plant. Thus, we may have the statement that solar resource is not closely associated with the solar plants location. 

But let's examine this statement more carefully. The density function will straightforwardly shows the concentration of solar plants, which help us more precisely locate where the solar power plants are concentrated.

```{r}
# transform the data into ppp format
us_boundary_proj <- st_transform(us_boundary, crs = 5070) 
solar_plants_proj <- st_transform(solar_plants_sf, crs = 5070)

solar_coords <- st_coordinates(solar_plants_proj)
solar_ppp <- ppp(
  x = solar_coords[, 1],
  y = solar_coords[, 2],
  window = as.owin(st_geometry(us_boundary_proj)))

# Create density function
solar_density <- density.ppp(solar_ppp, sigma = 100000)

solar_density_raster <- as.im(solar_density)
solar_density_df <- as.data.frame(solar_density_raster)

# Visualize the density
ggplot() +
  geom_raster(data = solar_density_df, aes(x = x, y = y, fill = value)) +
  scale_fill_viridis_c(option = "C", name = "Density") +
  geom_sf(data = us_boundary_proj, fill = NA, color = "white", size = 0.5) +
  labs(title = "Kernel Density of Solar Plants",
       x = "Longitude", y = "Latitude") +
  theme_minimal()
```
From graphs show above, we could conclude that the concentration of solar plants is in California, Virginia, Massachusetts and Minnesota, which are not closely align with the solar resource in the southwest. This phenomenon triggers author to explore other reasons influence the location of solar plants. The following analysis pick population factor as an example.

```{r}
# Import population data
population <- read.csv("data/population.csv") |>
  rename(State = Geographic.Area.Name, 
         population = Estimate..SEX.AND.AGE..Total.population) |>
  filter(!State %in% c("Hawaii", "Alaska", "Puerto Rico")) |>
  dplyr::select(State, population)

population_sf <- us_boundary |>
  left_join(population, by = c("name" = "State")) |>
  st_as_sf()

# Visualize the population distribution
ggplot() +
  geom_sf(data = population_sf, aes(fill = population)) +
  geom_sf(data = us_boundary, fill = NA, color = "black", size = 0.5) +
  scale_fill_viridis_c(option = "C", name = "Population") + 
  theme_minimal() +
  labs(title = "State Population Map",
       subtitle = "Population by State",
       caption = "Data Source: Your Data Source")
```

```{r}
# Count solar plants by state
solar_plant_count <- solar_plants_sf |>
  group_by(State) |>
  summarize(count = n()) |>
  left_join(population, by = c("State" = "State"))

# Regress the solar count and the population
ols_fit1 <- lm(count ~ log(population), data = solar_plant_count)
(ols_df1 <- broom::tidy(ols_fit1))
r_squared1 <- summary(ols_fit1)$r.squared

ggplot(solar_plant_count, aes(x = log(population), y = count)) +
  geom_point(size = 2, alpha = 0.7, color = "darkred") +
  geom_smooth(method = "lm", color = "blue") +
  labs(
    title = "Population vs. Solar Plant Count (Log Scale)",
    x = "Log(State Population)",
    y = "Solar Plant Count",
    caption = paste0("R² = ", round(r_squared1, 4))) +
  theme_minimal()

# Compare with GHI-count regression
solar_radiation_sf <- st_as_sf(solar_radiation_df, coords = c("x", "y"), crs = 4326)
nearest <- st_nearest_feature(solar_plant_count, solar_radiation_sf)
solar_plant_count$GHI <- solar_radiation_sf$GHI[nearest]

ols_fit2 <- lm(count ~ log(GHI), data = solar_plant_count)
(ols_df2 <- broom::tidy(ols_fit2))
r_squared2 <- summary(ols_fit2)$r.squared

ggplot(solar_plant_count, aes(x = log(GHI), y = count)) +
  geom_point(size = 2, alpha = 0.7, color = "darkred") +
  geom_smooth(method = "lm", color = "blue") +
  labs(
    title = "GHI vs. Solar Plant Count (Log Scale)",
    x = "Log(GHI)",
    y = "Solar Plant Count",
    caption = paste0("R² = ", round(r_squared2, 4))) +
  theme_minimal()
```

The R² value represents the proportion of the change in the dependent variable that the independent variable in the model can account for.

The results indicate that population size (R² = 0.2899) has a much stronger influence on the number of solar plants compared to solar radiation intensity (R² = 0.002). This suggests that solar plant siting decisions are more driven by population rather than solar irradiance. It reflects a siting strategy prioritizing accessibility over maximizing solar energy potential.

## Research Question 2: How does siting conflict between renewable and conventional power plants affect jobs and local economie?

```{r}
# Generate conflict zones
traditional_plants <- power_plants |>
  dplyr::select(State, PrimSource, Longitude, Latitude)|>
  filter(PrimSource == "coal", !State %in% c("Alaska", "Hawaii", "Puerto Rico"))

traditional_plants_sf <- st_as_sf(traditional_plants, coords = c("Longitude", "Latitude"), crs = 4326)

renewable_plants <- power_plants |>
  dplyr::select(State, PrimSource, Longitude, Latitude)|>
  filter(PrimSource %in% c("biomass", "geothermal", "hydroelectric", "natural gas", "nuclear", "solar", "wind"), !State %in% c("Alaska", "Hawaii", "Puerto Rico"))

renewable_plants_sf <-st_as_sf(renewable_plants, coords = c("Longitude", "Latitude"), crs = 4326)

# Identify and visualize conflict zones (within 10 km of traditional plants)
conflict_zones <- st_buffer(traditional_plants_sf, dist = 10000) |> st_union() |> st_make_valid() 
renewable_conflict <- st_intersection(renewable_plants_sf, conflict_zones)

us_county <- us_county <- counties(cb = TRUE, resolution = "20m") |>
  filter(!STATEFP %in% c("02", "15", "72")) 

us_county <- st_transform(us_county, crs = st_crs(renewable_conflict))
conflict_county <- st_intersection(us_county, renewable_conflict)
mapview(conflict_county)
```
We now identify the conflict county, where within 10km there is a renewable plants near the coal plants. Then, let's look at the employment rate and unemployment rate in these areas.

```{r}
# Calculate employment change rate and unemployment change rate
data_21 <- read_excel("data/laucnty21.xlsx") |>
  dplyr::select(name, abb, employed, unemployed) |>
  filter(!abb %in% c("AK", "HI", "PR"))

data_20 <- read_excel("data/laucnty20.xlsx") |>
  dplyr::select(name, abb, year, force, employed, unemployed) |>
  filter(!abb %in% c("AK", "HI", "PR"))

data_rate <- data_21 |>
  mutate(emp_change = ((data_21$employed - data_20$employed)/data_20$force)*100,
         unemp_change = ((data_21$unemployed - data_20$unemployed)/data_20$force)*100)

# Merge the data into map
rate_sf <- us_county |>
  left_join(data_rate, by = c("NAMELSAD" = "name", "STUSPS" = "abb"))
conflict_rate <- st_join(conflict_county, rate_sf)

# T-test the difference between conflict county and non conflict county
rate_sf <- rate_sf |>
  mutate(conflict_status = ifelse(NAMELSAD %in% conflict_county$NAMELSAD, "Conflict", "No Conflict"))

t_test_emp <- t.test(emp_change ~ conflict_status, data = rate_sf) |>
  print()
t_test_unemp <- t.test(unemp_change ~ conflict_status, data = rate_sf) |>
  print()
```
The t-test shows that the difference of employment growth rate between conflict and non-conflict counties isn't significant (p = 0.2328), while the unemployment growth rate is (p = 0.0546). The conflict counties having a lower unemployment growth rate (-2.22%) compared to non-conflict counties (-2.10%), meaning conflict areas may benefit, to some extent, from the presence of renewable energy facilities.

```{r}
# Visualize the unemployment and employment rate change
conflict_rate <- conflict_rate |>
  mutate(unemp_category = case_when(
    unemp_change > 0 ~ "Negative",
    unemp_change < 0 ~ "Positive",
    TRUE ~ "No Change"),
    emp_category = case_when(
    emp_change < 0 ~ "Negative",
    emp_change > 0 ~ "Positive",
    TRUE ~ "No Change"))

# Unemployment 
ggplot(conflict_rate) +
  geom_sf(data = us_boundary, fill = "skyblue", color = "black", size = 0.5, alpha = 0.6) +
  geom_sf(aes(color = unemp_category, size = unemp_change)) +
  scale_color_manual(
    values = c("Positive" = "darkgreen", "Negative" = "yellow", "No Change" = "gray"),
    name = "Change Category"
  ) +
  scale_size_continuous(name = "Unemployment Change Rate") +
  labs(
    title = "Unemployment Change (Categorized)",
    x = "Longitude",
    y = "Latitude"
  ) +
  theme_minimal()

# Employment
ggplot(conflict_rate) +
  geom_sf(data = us_boundary, fill = "skyblue", color = "black", size = 0.5, alpha = 0.6) +
  geom_sf(aes(color = emp_category, size = emp_change)) +
  scale_color_manual(
    values = c("Positive" = "darkgreen", "Negative" = "yellow", "No Change" = "gray"),
    name = "Change Category"
  ) +
  scale_size_continuous(name = "Employment Change Rate") +
  labs(
    title = "Employment Change (Categorized)",
    x = "Longitude",
    y = "Latitude"
  ) +
  theme_minimal()
```
From the graphs, we can see in the middle of the U.S., there is a greater economic disparities (higher unemployment rates and lower employment growth) than other conflict county. 

# Hypothesis Testing

Based on the research question 2, the author wants to further test Whether the distribution density of power plants in the conflict area is significantly higher than that in the non-conflict area, using Monte Carlo simulations.

```{r}
# Create ppp format
conflict_county_proj <- st_transform(conflict_county, crs = 5070)
conflict_ppp <- as.ppp(st_as_sfc(conflict_county_proj), W=as.owin(us_boundary_proj))

non_conflict_county <- st_difference(us_county, st_union(conflict_county))
non_conflict_county_proj <- st_transform(non_conflict_county, crs = 5070)
non_conflict_ppp <- as.ppp(st_as_sfc(non_conflict_county_proj), W=as.owin(us_boundary_proj))

conflict_density <- density.ppp(conflict_ppp, sigma = 50000)
non_conflict_density <- density.ppp(non_conflict_ppp, sigma = 50000)

# Simulations
set.seed(2024)
simulated_conflict_density <- replicate(999,density.ppp(rpoispp(lambda = intensity(conflict_ppp)), sigma = 50000), simplify = FALSE)

simulated_non_conflict_density <- replicate(999,density.ppp(rpoispp(lambda = intensity(non_conflict_ppp)), sigma = 50000), simplify = FALSE)

# Compare the oberved and simulated intensities
observed_conflict_values <- as.vector(conflict_density$v)
observed_non_conflict_values <- as.vector(non_conflict_density$v)

simulated_conflict_values <- sapply(simulated_conflict_density, function(d) as.vector(d$v))
simulated_non_conflict_values <- sapply(simulated_non_conflict_density, function(d) as.vector(d$v))

total_conflict_intensity <- sum(observed_conflict_values, na.rm = TRUE)
total_simulated_conflict_intensity <- rowSums(simulated_conflict_values, na.rm = TRUE)

# Compute the p-value
conflict_total_p_value <- mean(total_simulated_conflict_intensity > total_conflict_intensity)

cat("Observed Total Conflict Intensity:", total_conflict_intensity, "\n")
cat("p-value for Total Intensity:", conflict_total_p_value, "\n")
```
By calculating the density in non-conflict zones as a comparison, a meaningful control group has been introduced. This allows for a direct evaluation of whether the observed higher density in conflict zones is a result of the overlap between coal and renewable plants or if it reflects distinct spatial patterns.

Since the P-value is 0, it shows there is significant difference between conflict and non conflict zones. In other word, the power plants distribution in the conflict zone is not random, but has high spatial aggregation. 

# Discussion
This study reveal the factor that influencing the sitting of solar plants and the economic impact of conflict sitting between renewable and conventional energy plants.

First, analysis of question 1 shows that the location of solar plants in the United States is more influenced by population density than by solar radiation intensity.  While this approach may be consistent with current economic incentives, it also raises concerns about under-utilization in areas with high solar resources, particularly in the southwestern United States.

Second, analysis of question 2 indicates that the coexistence of renewable and traditional energy sources may have mitigated the negative effects on the labor market to some extent. In addition, the spatial clustering of power plants is not a random phenomenon, yet may driven by some economic or policy factors.

# Conclusion
This study highlights issues in the siting and economic impacts of solar plants in the United States, while still has room for data improvement. 

First, the analysis of the first question only pick the population as a alternative factor. Other critical factors like land costs and policy incentives were not included, limiting the comprehensiveness of the conclusions. 

Additionally, while unemployment growth rates in conflict zones were significantly lower than in non-conflict zones, the quality of jobs and long-term impacts remain unclear. 

Future research should incorporate more variables and extend the time frame to better understand the complex dynamics of renewable energy transitions and support evidence-based policy making.

<!-- # References -->
